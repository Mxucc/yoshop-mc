import{_ as t}from"./u-tabs.ac16122d.js";import{$ as e,q as a,u as s,o as i,c as l,w as r,n as o,i as c,a as n,b as u,d,F as m,y as h,k as _,f as p,t as f,e as g,l as b,g as L}from"./index-3b24b149.js";import{r as y}from"./uni-app.es.9206f90a.js";import{M as T,_ as w}from"./mescroll-mixins.57cfe76c.js";import{l as v}from"./index.138c963c.js";import{_ as x}from"./_plugin-vue_export-helper.1b428a4d.js";const C="article.category/list";const k=x({mixins:[T],data:()=>({tabList:[],curTab:0,articleList:a(),upOption:{auto:!0,page:{size:15},noMoreSize:3}}),onLoad(t){this.getCategoryList(t.categoryId)},methods:{upCallback(t){const e=this;e.getArticleList(t.num).then((t=>{const a=t.data.length,s=t.data.total;e.mescroll.endBySize(a,s)})).catch((()=>e.mescroll.endErr()))},getCategoryList(t){e.get(C).then((e=>{this.setTabList(e.data.list,t)}))},setTabList(t,e){const a=this;if(a.tabList=[{value:0,name:"全部"}],t.forEach((t=>{a.tabList.push({value:t.category_id,name:t.name})})),e>0){const t=a.tabList.findIndex((t=>t.value==e));a.curTab=t>-1?t:0}},getArticleList(t=1){const e=this;return new Promise(((a,i)=>{v({categoryId:e.getTabValue(),page:t},{load:!1}).then((i=>{const l=i.data.list;e.articleList.data=s(l,e.articleList,t),a(l)})).catch(i)}))},onChangeTab(t){this.curTab=t,this.onRefreshList()},getTabValue(){const t=this;return t.tabList.length?t.tabList[t.curTab].value:0},onRefreshList(){this.articleList=a(),setTimeout((()=>this.mescroll.resetUpScroll()),120)},onTargetDetail(t){this.$navTo("pages/article/detail",{articleId:t})}},onShareAppMessage(){return{title:"文章首页",path:"/pages/article/index?"+this.$getShareUrlParams()}},onShareTimeline(){return{title:"文章首页",path:"/pages/article/index?"+this.$getShareUrlParams()}}},[["render",function(e,a,s,T,v,x){const C=y(h("u-tabs"),t),k=b,I=c,S=L,j=y(h("mescroll-body"),w);return i(),l(I,{class:"container",style:o(e.appThemeStyle)},{default:r((()=>[n(j,{ref:"mescrollRef",sticky:!0,onInit:e.mescrollInit,down:{use:!1},up:v.upOption,onUp:x.upCallback},{default:r((()=>[n(C,{list:v.tabList,"is-scroll":!0,current:v.curTab,"active-color":e.appTheme.mainBg,duration:.2,onChange:x.onChangeTab},null,8,["list","current","active-color","duration","onChange"]),n(I,{class:"article-list"},{default:r((()=>[(i(!0),u(m,null,d(v.articleList.data,((t,e)=>(i(),l(I,{class:_(["article-item",[`show-type__${t.show_type}`]]),key:e,onClick:e=>x.onTargetDetail(t.article_id)},{default:r((()=>[10==t.show_type?(i(),u(m,{key:0},[n(I,{class:"article-item__left flex-box"},{default:r((()=>[n(I,{class:"article-item__title"},{default:r((()=>[n(k,{class:"twoline-hide"},{default:r((()=>[p(f(t.title),1)])),_:2},1024)])),_:2},1024),n(I,{class:"article-item__footer m-top10"},{default:r((()=>[n(k,{class:"article-views f-24 col-8"},{default:r((()=>[p(f(t.show_views)+"次浏览",1)])),_:2},1024)])),_:2},1024)])),_:2},1024),n(I,{class:"article-item__image"},{default:r((()=>[n(S,{class:"image",mode:"widthFix",src:t.image_url},null,8,["src"])])),_:2},1024)],64)):g("",!0),20==t.show_type?(i(),u(m,{key:1},[n(I,{class:"article-item__title"},{default:r((()=>[n(k,{class:"twoline-hide"},{default:r((()=>[p(f(t.title),1)])),_:2},1024)])),_:2},1024),n(I,{class:"article-item__image m-top20"},{default:r((()=>[n(S,{class:"image",mode:"widthFix",src:t.image_url},null,8,["src"])])),_:2},1024),n(I,{class:"article-item__footer m-top10"},{default:r((()=>[n(k,{class:"article-views f-24 col-8"},{default:r((()=>[p(f(t.show_views)+"次浏览",1)])),_:2},1024)])),_:2},1024)],64)):g("",!0)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1},8,["onInit","up","onUp"])])),_:1},8,["style"])}],["__scopeId","data-v-1ba9f3eb"]]);export{k as default};
